import{a3 as F,j as e,M as j,f as I,aJ as M,ak as z,r as a,af as C,b1 as R,k as b,a0 as A,h as g,G as x,a2 as L,b2 as E,a5 as K,b0 as O,i as q,q as B,aa as V,z as H}from"./react-vendor-CllrtqDN.js";import{N as y,b as G,o as P,h as $,p as J,q as Q,A as _}from"./index-DRsVs7hl.js";import{S as W}from"./SelectDecksHeader-CuZFQzvD.js";import{t as Y}from"./utils-UxpEuF8F.js";import{at as U}from"./vendor-kP31MWcD.js";import{u as X,N as Z,E as ee}from"./NoteMenu-DjJPjBu1.js";import{N as te}from"./NoteSubmitButton-B013PIhx.js";import"./database-_ZSyCo0Q.js";import"./editor-C2bVNK98.js";import"./rxjs-DNGqVrHU.js";import"./mantine-charts-Bb-jmQwj.js";import"./DangerousConfirmModal-DL1P1d32.js";import"./deleteNote-wh9Y2_6_.js";function se({}){const t=F();return e.jsxs(j,{children:[e.jsx(j.Target,{children:e.jsx(I,{variant:"subtle",color:"gray",children:e.jsx(M,{})})}),e.jsx(j.Dropdown,{children:e.jsx(j.Item,{leftSection:e.jsx(z,{}),onClick:()=>t("/settings/editing"),children:"Editing Options"})})]})}const oe="_row_t7xat_1",re="_selected_t7xat_13",S={row:oe,selected:re};function ie({noteSet:t,openedNote:r,setOpenedNote:n,setSort:i,openModal:o}){const[d,h]=a.useState([]),[c,w]=a.useState({columnAccessor:"sortField",sortKey:"bySortField",direction:"asc"});a.useEffect(()=>{i([y[c.sortKey],c.direction==="asc"])},[c]);const u=C("(pointer: coarse)"),p=C("(max-width: 50em)");return e.jsx(R,{className:S.table,records:t,columns:[{accessor:"sortField",title:"Name",ellipsis:!0,width:200,resizable:!0,filtering:!0,sortable:!0,sortKey:"bySortField"},{accessor:"creationDate",title:"Creation Date",render:s=>s.creationDate.toLocaleDateString(),resizable:!0,sortable:!0,sortKey:"byCreationDate"},{accessor:"content.type",title:"Note Type",resizable:!0,sortable:!0,sortKey:"byType"}],withTableBorder:!1,withRowBorders:!1,highlightOnHover:!0,borderRadius:"md",striped:"odd",height:"100%",textSelectionDisabled:u,selectionCheckboxProps:{size:p?"sm":"xs"},selectedRecords:d,onSelectedRecordsChange:h,sortStatus:c,onSortStatusChange:w,rowClassName:s=>U({[S.selected]:s.id===(r==null?void 0:r.id),[S.row]:!0}),onRowClick:s=>{n(s.record),p&&o()},onRowDoubleClick:s=>{n(s.record),o()}})}function ae({note:t}){return t?e.jsx(ce,{note:t}):e.jsx(ne,{})}function ne(){return e.jsx(b,{fz:"sm",c:"dimmed",children:"No note selected"})}function ce({note:t}){const[r]=A(),[n]=X(t),[i,o]=a.useState(!1),d=a.useMemo(()=>n?G(t).editor({note:t,deck:n,mode:"edit",requestedFinish:i,setRequestedFinish:o}):null,[t,n,i,o]);return e.jsxs(g,{style:{height:"100%",overflowY:"scroll"},gap:"xl",children:[e.jsxs(x,{justify:"space-between",wrap:"nowrap",children:[e.jsx(x,{children:e.jsxs(b,{fz:"xs",fw:600,children:[r("note.edit.title")," ",e.jsxs(b,{c:"dimmed",span:!0,fz:"xs",fw:600,children:["(",P[t.content.type],")"]})]})}),e.jsx(Z,{note:t,withEdit:!1})]}),d,e.jsx(x,{justify:"end",children:e.jsx(te,{finish:()=>o(!0),mode:"edit"})})]})}const le="_container_ojsw2_1",de="_noteDisplay_ojsw2_18",v={container:le,noteDisplay:de},ue="all";function ke(){var k;const t=F(),r=L(),[n]=$();let i=E().deckId;i===ue&&(i=void 0);const o=E().noteId,{sortFunction:d,sortDirection:h}=(k=r.state)!=null?k:{},[c,w]=K("",250),[u,p]=a.useState([d!==void 0?y[d]:y.bySortField,h!==void 0?h:!0]),[s]=J(l=>l.orderBy("sortField").filter(m=>m.sortField.toLowerCase().includes(c.toLowerCase())&&(i===void 0||m.deck===i)).toArray().then(m=>m.sort(u[0](u[1]?1:-1))),[r,c,r,u]),[T,N]=a.useState(!1),[f,D]=a.useState();return a.useEffect(()=>{o&&Q(o).then(l=>{l&&D(l)})},[o]),e.jsxs(g,{style:{overflow:"hidden",width:"100%",height:"100%"},children:[e.jsx(_,{children:e.jsx(_,{children:e.jsxs(x,{justify:"space-between",gap:"xs",wrap:"nowrap",children:[e.jsx(O,{}),e.jsx(q,{order:3,children:Y("manage-cards.title")}),e.jsx(se,{})]})})}),e.jsx(x,{align:"end",gap:"xs",children:e.jsx(W,{label:"Showing Notes in",decks:n,onSelect:l=>t(`/notes/${l}`)})}),e.jsxs("div",{className:v.container,children:[e.jsxs(g,{children:[e.jsx(B,{leftSection:e.jsx(V,{size:16}),defaultValue:c,placeholder:"Filter Notes",w:"100%",onChange:l=>w(l.currentTarget.value)}),s&&e.jsx(ie,{noteSet:s!=null?s:[],openedNote:f,setOpenedNote:D,openModal:()=>N(!0),sort:u,setSort:p})]}),e.jsx(H,{className:v.noteDisplay,children:e.jsx(ae,{note:f})})]}),f&&e.jsx(ee,{note:f,setClose:()=>N(!1),opened:T})]})}export{ke as default};
